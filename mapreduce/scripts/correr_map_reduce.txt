#!/bin/bash

# --- CONFIGURACIÃ“N ---
SCRIPT_PY="total_gdp_by_department.py"
INPUT_HDFS_PATH="hdfs:///user/hadoop/entrada/cleaned_gdp_data.csv"
OUTPUT_HDFS_DIR="hdfs:///user/hadoop/salida"
LOCAL_OUTPUT_FILE="resultados.csv"
S3_BUCKET="pruebas-telematica"
S3_DEST_PATH="output/resultados.csv"

hdfs dfs -rm -r -f $OUTPUT_HDFS_DIR

python3 $SCRIPT_PY -r hadoop $INPUT_HDFS_PATH --output-dir $OUTPUT_HDFS_DIR

hdfs dfs -getmerge $OUTPUT_HDFS_DIR $LOCAL_OUTPUT_FILE

aws s3 cp $LOCAL_OUTPUT_FILE s3://$S3_BUCKET/$S3_DEST_PATH

